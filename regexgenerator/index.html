<!DOCTYPE html>
<html lang="en">
<head>
    <title>RegexGenerator</title>
    <link rel="icon" href="./src/favicon.ico" type="image/x-icon">
</head>
<body style="background-color: #1d3956; color: mediumseagreen; font-family:'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif; text-transform: uppercase; font-size: 20px;">
    <div>
        <center>
            <h1>
                Regex Generator
            </h1>
        </center>
    </div>
    <div class="input">
        <center>
            <input id="textinput" type="text" placeholder="Insert Text" minlength="1">
        </center>
    </div>
    <br>
    <div id="submitdiv">
        <center>
            <button onclick="submitregex()">
                Submit
            </button>
        </center>
    </div>
    <br>
    <div style="border: solid; padding: 10px;">
        <center>
            <h id="regexoutput" style="text-transform: none;">
                Regex shows up here
            </h>
            <button id="regexcopy" onclick="copyregex()">
                Copy Regex
            </button>
            <br>
            <br>
            <h id="regexrawoutput" style="text-transform: none;">
                Raw Regex shows up here
            </h>
            <button id="regexcopyraw" onclick="copyregexraw()">
                Copy Raw Regex
            </button>
            <br>
        </center>
    </div>
</body>
</html>


<script>
    document.onload = syncreplaces()

    let replaces = ""        
    
    function syncreplaces(){
        fetch("./replaces.txt")
        .then(data => {
            data.text().then(x => {
                // console.log(x)
                replaces = x.replace(/(\r)/g, "")
            })
            console.log("Successfully Fetched Lookalikes")
        })
        .catch(err => {
            location.reload()
            console.log("Failed to Fetch Lookalikes - Reloading")
        })
    }

    let regex = "config:any regi:"
    let regexraw = ""
    let regexarr = []
    let alphabet = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"]
    let nomatch = ["(", ")"]
    function submitregex(){
        let regextext = document.getElementById("textinput").value
        regexarr = []
        if(regextext.length > 0){
            let num = 0
            regextext.split("").forEach(x => {
                if(x === " "){
                    if(num === 0 || nomatch.includes(regexarr[num-1])){
                        regexarr.push("\\s*")
                    } else {
                        if(regexarr[num-1].endsWith("+[\\W_]*")){
                            regexarr[num-1] = regexarr[num-1].split("+[\\W_]*")[0]
                        } 
                        regexarr.push("+\\s")
                    }
                } else {
                    if(alphabet.includes(x)){
                        if(num === 0 || nomatch.includes(regexarr[num-1])){
                            regexarr.push(`[${replaces.split("\n")[alphabet.indexOf(x)].split(" ")[0]}]+[\\W_]*`)
                        } else {
                            regexarr.push(`+[${replaces.split("\n")[alphabet.indexOf(x)].split(" ")[0]}]+[\\W_]*`)
                        }
                    } else {
                        if(num === 0 || nomatch.includes(regexarr[num-1])){
                            if((x === "(") || (x === ")")){
                                regexarr.push(x)
                            } else {
                                regexarr.push(`${x}+[\\W_]*`)
                            }
                        } else {
                            if((x === "(") || (x === ")")){
                                regexarr.push(x)
                            } else {
                                regexarr.push(`+${x}+[\\W_]*`)
                            }
                        }
                    }
                }
                num++
            })
            document.getElementById("regexoutput").innerHTML = `config:any regi:${regexarr.join("")}`
            document.getElementById("regexrawoutput").innerHTML = `${regexarr.join("")}`
        }
    }
    
    function copyregex(){
        navigator.clipboard.writeText(`config:any regi:${regexarr.join("")}`);
        let colorfirst = document.getElementById("regexcopy").style.backgroundColor
        document.getElementById("regexcopy").style.backgroundColor = "green"
        setTimeout(() => {
            document.getElementById("regexcopy").style.backgroundColor = colorfirst
        }, 3000)
    }

    function copyregexraw(){
        navigator.clipboard.writeText(`${regexarr.join("")}`);
        let colorfirsta = document.getElementById("regexcopyraw").style.backgroundColor
        document.getElementById("regexcopyraw").style.backgroundColor = "green"
        setTimeout(() => {
            document.getElementById("regexcopyraw").style.backgroundColor = colorfirsta
        }, 3000)
    }
</script>